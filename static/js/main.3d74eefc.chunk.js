(this.webpackJsonponlyconnect=this.webpackJsonponlyconnect||[]).push([[0],{15:function(e,n,t){},16:function(e,n,t){},17:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t(1),c=t.n(o),a=t(9),u=t.n(a),s=(t(15),t(7)),l=t(2);function i(e){return e.replace(/~/g,"")}function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{answerGroup:e,clue:i(n),selected:!1,badGuess:!1,solvedGroup:null}}var f=t(5),v=t(6);var h=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"doInt",value:function(e){var n=e*this.prime+Math.floor(Math.random()*this.prime);if(this.undoInt(n)!==e)throw new Error("DumbEncypt.doInt Cannot encrypt ".concat(e));return n}},{key:"undoInt",value:function(e){return Math.floor(e/this.prime)}}]),e}();h.prime=19793;var j=function(e){var n=e.coreSquare,t=e.index,o=e.onSelect,c="square";n.selected&&(c+=" selected"),n.badGuess&&(c+=" bad-guess");var a,u=n.solvedGroup;return null!==u&&((a=u)>=1&&a<=4?c+=" group"+n.solvedGroup:console.log("Invalid solved group for",n)),Object(r.jsx)("div",{onClick:function(){o&&o(t)},className:c,children:n.clue})},b=function(e){var n=e.coreSquares,t=e.onSelect;return Object(r.jsx)("div",{className:"wall",children:n.map((function(e,n){return Object(r.jsx)(j,{index:n,coreSquare:e,onSelect:t},n.toString())}))})};var p=function(e){var n=e.coreSquares,t=e.hasBadGuess,o=e.clueSelected,c=e.doClearGuess,a=e.doRestart,u=function(){return Object(r.jsx)("button",{type:"button",onClick:c,children:"Clear guess"})},s=function(){return Object(r.jsx)("button",{className:"restart-button",type:"button",onClick:a,children:"Restart"})};return Object(r.jsxs)("div",{className:"solving-area",children:[Object(r.jsx)(b,{coreSquares:n,onSelect:o}),Object(r.jsxs)("div",{className:"solving-controls",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(u,{}),t?Object(r.jsx)("div",{children:"Wrong!"}):null]}),Object(r.jsx)(s,{})]})]})},g=function(){function e(n){Object(f.a)(this,e),this._key=void 0,this._key=n}return Object(v.a)(e,[{key:"get",value:function(){var e=localStorage.getItem(this._key);return e?JSON.parse(e):null}},{key:"set",value:function(e){if(null===e||void 0===e)localStorage.removeItem(this._key);else{var n=JSON.stringify(e);localStorage.setItem(this._key,n)}}}],[{key:"make",value:function(n){return new e(n.map((function(e){return e.clue})).join())}},{key:"clearAll",value:function(){localStorage.clear()}}]),e}();function O(e){console.log("Pre-trimmed",e);var n=[];for(var t in e){var r=e[t].trim();r&&n.push(r)}return n}var m=function(e){var n=e.recordClues,t=Object(o.useState)(""),c=Object(l.a)(t,2),a=c[0],u=c[1],s=Object(o.useState)(""),i=Object(l.a)(s,2),d=i[0],f=i[1],v=function(){return d?Object(r.jsx)("div",{children:"Error: "+d}):null};return Object(r.jsxs)("div",{className:"setting-area",children:[Object(r.jsx)("p",{children:"Enter clues.  These can be single words, or words and phrases seperated by commas"}),Object(r.jsx)("textarea",{cols:50,rows:4,onChange:function(e){u(e.target.value)}}),Object(r.jsxs)("div",{className:"setting-area-buttons",children:[Object(r.jsx)("button",{className:"done-button",onClick:function(){f("");var e=O(a.split(/[,\s]/));if(console.log("Space separated",e),16!==e.length){var t=function(e){return O(e.split(/[,\n]/))}(a);console.log("Comma separated",t),16!==t.length?f("Did not find 16 clues: \n            ".concat(e.length," found with space seperation.\n            ").concat(t.length," found with comma-seperation.")):n(t)}else n(e)},children:"Done"}),Object(r.jsx)("button",{className:"clear-stored-solutions-button",onClick:g.clearAll,children:"Clear stored solutions"})]}),Object(r.jsx)(v,{})]})};function w(e){var n=function(e){var n=e.get("clues");if(n){var t=n.split("~");if(16===t.length)return t;console.log("Did not find the expected number of clues",t)}return null}(e),t=function(e){var n=null,t=e.get("key");if(t){var r=h.undoInt(parseInt(t));n=[];for(var o=0;o<16;++o){var c=r%4;r=(r-c)/4,n.push(c)}n.reverse();for(var a=function(e){4!==n.filter((function(n){return n===e})).length&&(console.log("Cannot interpret urlKey",t),n=null)},u=0;n&&u<4;++u)a(u)}return n}(e);if(Boolean(n)!==Boolean(t))throw console.log("window.location.search",window.location.search,"\nurlClue",n,"\nurlSolutionGroups",t),new Error("Could not understand URL parameters");if(n&&t){for(var r=[],o=0;o<16;++o)r.push(d(t[o],n[o]));return r}return null}var x=function(){var e=function(){try{return w(new URLSearchParams(window.location.search))}catch(e){console.log(e),alert("URL appears incorrect")}return null}(),n=Boolean(e),t=e&&function(e){try{return g.make(e)}catch(n){console.log(n),alert("Problem getting recorded data")}return null}(e);if(t){var r=t.get();r&&function(e){return 16===e.length||(alert("Recorded data appears incorrect"),!1)}(r)&&(e=r)}return[e=e||function(){for(var e=[],n=0;n<4;++n)for(var t=0;t<4;++t)e.push(d(n));return e}(),n,t]};t(16);function S(e){return Math.floor(e/4)+1}function y(e,n){!function(e,n){for(var t=0;t<e.length;++t){var r=S(t),o=e[t].solvedGroup;if(r<n){if(r!==o)throw new Error("square ".concat(t," is not in solved group ").concat(r));if(o>n)throw new Error("square ".concat(t," is in unexpected solved fron ").concat(o))}}}(e,n);for(var t=0;t<e.length;++t){if(e[t].solvedGroup===n&&S(t)!==n){var r=e.findIndex((function(e){return!e.solvedGroup}));if(S(r)!==n)throw new Error("Bah! Something has gone wrong");var o=[e[r],e[t]];e[t]=o[0],e[r]=o[1]}}}var G=x(),k=Object(l.a)(G,3),C=k[0],E=k[1],I=k[2],N=function(){var e=Object(o.useState)(C),n=Object(l.a)(e,2),t=n[0],c=n[1],a=Object(o.useState)(!1),u=Object(l.a)(a,2),i=u[0],f=u[1];Object(o.useEffect)((function(){document.title="OnlyConnect"}));var v=Boolean(t.find((function(e){return e.badGuess})));if(E)return Object(r.jsx)(p,{coreSquares:t,hasBadGuess:v,clueSelected:function(e){if(E&&!t[e].solvedGroup){var n=Object(s.a)(t);n.forEach((function(e){return e.badGuess=!1})),n[e].selected=!n[e].selected;var r=n.filter((function(e){return e.selected}));if(r.find((function(e){return e.solvedGroup})))throw new Error("Selected square is already solved");if(4===r.length)if(r.forEach((function(e){return e.selected=!1})),r.every((function(e){return e.answerGroup===r[0].answerGroup}))){var o=function(e){for(var n=function(n){if(e.find((function(e){return e&&e.solvedGroup===n})))return{v:n}},t=4;t>0;--t){var r=n(t);if("object"===typeof r)return r.v}return 0}(n)+1;r.forEach((function(e){return e.solvedGroup=o})),y(n,o),o+1===4&&n.forEach((function(e){e.solvedGroup||(e.solvedGroup=4)}))}else r.forEach((function(e){return e.badGuess=!0}));I.set(n),c(n)}},doClearGuess:function(){var e=Object(s.a)(t);e.forEach((function(e){e.badGuess=!1,e.selected=!1})),c(e)},doRestart:function(){I.set(null),window.location.reload()}});var j=function(){var e=function(e){var n=new URLSearchParams,t="";e.forEach((function(e){return t+=e.clue+"~"})),n.append("clues",t.slice(0,-1));var r=0;e.forEach((function(e){return r=4*r+e.answerGroup}));var o=h.doInt(r);return n.append("key",o.toString()),n}(function(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),r=[e[t],e[n]];e[n]=r[0],e[t]=r[1]}return e}(Object(s.a)(t))),n=window.location.href+"?"+e.toString();return Object(r.jsxs)("div",{children:[Object(r.jsx)(b,{coreSquares:t}),Object(r.jsxs)("div",{children:[" ",Object(r.jsx)("a",{href:n,target:"blank",children:"Randomised (Playable)"})," "]})]})};return Object(r.jsxs)("div",{className:"setting-area",children:[Object(r.jsx)(m,{recordClues:function(e){e?function(e){var n=e.map((function(e,n){return d(Math.floor(n/4),e)}));c(n),f(!0)}(e):f(!1)}}),i?Object(r.jsx)(j,{}):null]})},q=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,18)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,c=n.getLCP,a=n.getTTFB;t(e),r(e),o(e),c(e),a(e)}))};u.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(N,{})}),document.getElementById("root")),q()}},[[17,1,2]]]);
//# sourceMappingURL=main.3d74eefc.chunk.js.map