(this.webpackJsonponlyconnect=this.webpackJsonponlyconnect||[]).push([[0],{15:function(e,n,r){},16:function(e,n,r){},17:function(e,n,r){"use strict";r.r(n);var t=r(0),o=r(1),c=r.n(o),a=r(7),u=r.n(a),s=(r(15),r(5)),i=r(2);function l(e){return e.replace(/~/g,"")}function f(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{answerGroup:e,clue:l(n),selected:!1,badGuess:!1,solvedGroup:null}}function d(e){return e>=1&&e<=4}var v=function(e){var n=e.coreSquare,r=e.index,o=e.onSelect,c="square";n.selected&&(c+=" selected"),n.badGuess&&(c+=" bad-guess");var a=n.solvedGroup;return null!==a&&(d(a)?c+=" group"+n.solvedGroup:console.log("Invalid solved group for",n)),Object(t.jsx)("div",{onClick:function(){o&&o(r)},className:c,children:n.clue})},h=function(e){var n=e.coreSquares,r=e.onSelect;return Object(t.jsx)("div",{className:"wall",children:n.map((function(e,n){return Object(t.jsx)(v,{index:n,coreSquare:e,onSelect:r},n.toString())}))})};var j=function(e){var n=e.coreSquares,r=e.hasBadGuess,o=e.clueSelected,c=e.doClearGuess,a=e.doRestart,u=function(){return Object(t.jsx)("button",{type:"button",onClick:c,children:"Clear guess"})},s=function(){return Object(t.jsx)("button",{className:"restart-button",type:"button",onClick:a,children:"Restart"})};return Object(t.jsxs)("div",{className:"solving-area",children:[Object(t.jsx)(h,{coreSquares:n,onSelect:o}),Object(t.jsxs)("div",{className:"solving-controls",children:[Object(t.jsxs)("div",{children:[Object(t.jsx)(u,{}),r?Object(t.jsx)("div",{children:"Wrong!"}):null]}),Object(t.jsx)(s,{})]})]})};function b(e){console.log("Pre-trimmed",e);var n=[];for(var r in e){var t=e[r].trim();t&&n.push(t)}return n}var p=function(e){var n=e.recordClues,r=Object(o.useState)(""),c=Object(i.a)(r,2),a=c[0],u=c[1],s=Object(o.useState)(""),l=Object(i.a)(s,2),f=l[0],d=l[1],v=function(){return f?Object(t.jsx)("div",{children:"Error: "+f}):null};return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsxs)("div",{children:[Object(t.jsx)("p",{children:"Enter clues.  These can be single words, or words and phrases seperated by commas"}),Object(t.jsx)("textarea",{cols:50,rows:4,onChange:function(e){u(e.target.value)}})]}),Object(t.jsx)("button",{className:"done-button",onClick:function(){d("");var e=b(a.split(/[,\s]/));if(console.log("Space separated",e),16!==e.length){var r=function(e){return b(e.split(/[,\n]/))}(a);console.log("Comma separated",r),16!==r.length?d("Did not find 16 clues: \n            ".concat(e.length," found with space seperation.\n            ").concat(r.length," found with comma-seperation.")):n(r)}else n(e)},children:"Done"}),Object(t.jsx)(v,{})]})},g=r(8),O=r(9);var m=function(){function e(){Object(g.a)(this,e)}return Object(O.a)(e,null,[{key:"doInt",value:function(e){var n=e*this.prime+Math.floor(Math.random()*this.prime);if(this.undoInt(n)!==e)throw new Error("DumbEncypt.doInt Cannot encrypt ".concat(e));return n}},{key:"undoInt",value:function(e){return Math.floor(e/this.prime)}}]),e}();m.prime=19793;var w=[],S=!1;function x(){if(16!==w.length)throw new Error("Cannot find storage key - clue words are not set");return w.map((function(e){return e.clue})).join()}function G(){var e=new URLSearchParams(window.location.search),n=function(e){var n=e.get("clues");if(n){var r=n.split("~");if(16===r.length)return r;console.log("Did not find the expected number of clues",r)}return null}(e),r=function(e){var n=null,r=e.get("key");if(r){var t=m.undoInt(parseInt(r));n=[];for(var o=0;o<16;++o){var c=t%4;t=(t-c)/4,n.push(c)}n.reverse();for(var a=function(e){4!==n.filter((function(n){return n===e})).length&&(console.log("Cannot interpret urlKey",r),n=null)},u=0;n&&u<4;++u)a(u)}return n}(e);if(S=!1,n&&r){S=!0;for(var t=0;t<16;++t)w.push(f(r[t],n[t]))}else{e.toString()&&alert("Could not understand URL parameters");for(var o=0;o<4;++o)for(var c=0;c<4;++c){var a=f(o);w.push(a)}}}function y(e){if(null!==e.solvedGroup&&!d(e.solvedGroup))throw new Error("Bad solved group in recorded square")}function E(e){if(null===e)localStorage.removeItem(x());else{e.forEach(y);var n=JSON.stringify(e);localStorage.setItem(x(),n)}}function C(){var e=null;try{e=function(){var e=localStorage.getItem(x());if(null===e)return null;var n=JSON.parse(e);if(!n)return null;if(16!==n.length)throw new Error("Stored array does not have the expected length");return n.forEach((function(e){return y(e)})),n}()}catch(n){alert("Error reading stored data")}return e}r(16);function q(e){return Math.floor(e/4)+1}var I=function(){G();var e=C();return{cluesSetByURL:S,startingSquares:e||w}}(),k=I.startingSquares,B=I.cluesSetByURL;function N(e,n){!function(e,n){for(var r=0;r<e.length;++r){var t=q(r),o=e[r].solvedGroup;if(t<n){if(t!==o)throw new Error("square ".concat(r," is not in solved group ").concat(t));if(o>n)throw new Error("square ".concat(r," is in unexpected solved fron ").concat(o))}}}(e,n);for(var r=0;r<e.length;++r){if(e[r].solvedGroup===n&&q(r)!==n){var t=e.findIndex((function(e){return!e.solvedGroup}));if(q(t)!==n)throw new Error("Bah! Something has gone wrong");var o=[e[t],e[r]];e[r]=o[0],e[t]=o[1]}}}var R=function(){var e=Object(o.useState)(k),n=Object(i.a)(e,2),r=n[0],c=n[1],a=Object(o.useState)(!1),u=Object(i.a)(a,2),l=u[0],d=u[1];Object(o.useEffect)((function(){document.title="OnlyConnect"}));var v=Boolean(r.find((function(e){return e.badGuess})));if(B)return Object(t.jsx)(j,{coreSquares:r,hasBadGuess:v,clueSelected:function(e){if(B&&!r[e].solvedGroup){var n=Object(s.a)(r);n.forEach((function(e){return e.badGuess=!1})),n[e].selected=!n[e].selected;var t=n.filter((function(e){return e.selected}));if(t.find((function(e){return e.solvedGroup})))throw new Error("Selected square is already solved");if(4===t.length)if(t.forEach((function(e){return e.selected=!1})),t.every((function(e){return e.answerGroup===t[0].answerGroup}))){var o=function(e){for(var n=function(n){if(e.find((function(e){return e&&e.solvedGroup===n})))return{v:n}},r=4;r>0;--r){var t=n(r);if("object"===typeof t)return t.v}return 0}(n)+1;t.forEach((function(e){return e.solvedGroup=o})),N(n,o),o+1===4&&n.forEach((function(e){e.solvedGroup||(e.solvedGroup=4)}))}else t.forEach((function(e){return e.badGuess=!0}));E(n),c(n)}},doClearGuess:function(){var e=Object(s.a)(r);e.forEach((function(e){e.badGuess=!1,e.selected=!1})),c(e)},doRestart:function(){E(null),window.location.reload()}});var b=function(){var e=function(e){var n=new URLSearchParams,r="";e.forEach((function(e){return r+=e.clue+"~"})),n.append("clues",r.slice(0,-1));var t=0;e.forEach((function(e){return t=4*t+e.answerGroup}));var o=m.doInt(t);return n.append("key",o.toString()),n}(function(e){for(var n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),t=[e[r],e[n]];e[n]=t[0],e[r]=t[1]}return e}(Object(s.a)(r))),n=window.location.href+"?"+e.toString();return Object(t.jsxs)("div",{children:[Object(t.jsx)(h,{coreSquares:r}),Object(t.jsxs)("div",{children:[" ",Object(t.jsx)("a",{href:n,target:"blank",children:"Randomised (Playable)"})," "]})]})};return Object(t.jsxs)("div",{className:"setting-area",children:[Object(t.jsx)(p,{recordClues:function(e){e?function(e){var n=e.map((function(e,n){return f(Math.floor(n/4),e)}));c(n),d(!0)}(e):d(!1)}}),l?Object(t.jsx)(b,{}):null]})},M=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,18)).then((function(n){var r=n.getCLS,t=n.getFID,o=n.getFCP,c=n.getLCP,a=n.getTTFB;r(e),t(e),o(e),c(e),a(e)}))};u.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(R,{})}),document.getElementById("root")),M()}},[[17,1,2]]]);
//# sourceMappingURL=main.64f833e2.chunk.js.map